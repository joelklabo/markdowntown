@tailwind base;
@tailwind components;
@tailwind utilities;

/* Design tokens V2: primitives â†’ semantic roles with light/dark support */
:root {
  /* ==== Primitive palette (light) ==== */
  /* Neutrals */
  --mdt-neutral-0: hsl(220 30% 99%);
  --mdt-neutral-25: hsl(220 30% 98%);
  --mdt-neutral-50: hsl(220 28% 96%);
  --mdt-neutral-100: hsl(220 22% 92%);
  --mdt-neutral-200: hsl(220 18% 86%);
  --mdt-neutral-300: hsl(220 16% 78%);
  --mdt-neutral-400: hsl(222 14% 62%);
  --mdt-neutral-500: hsl(222 16% 48%);
  --mdt-neutral-600: hsl(222 22% 38%);
  --mdt-neutral-700: hsl(222 34% 24%);
  --mdt-neutral-800: hsl(222 42% 14%);
  --mdt-neutral-900: hsl(222 50% 9%);
  --mdt-neutral-950: hsl(222 58% 5%);

  /* Brand (blue) */
  --mdt-brand-50: hsl(198 100% 96%);
  --mdt-brand-100: hsl(198 95% 90%);
  --mdt-brand-200: hsl(198 92% 82%);
  --mdt-brand-300: hsl(198 90% 72%);
  --mdt-brand-400: hsl(198 88% 62%);
  --mdt-brand-500: hsl(198 85% 52%);
  --mdt-brand-600: hsl(198 87% 42%);
  --mdt-brand-700: hsl(198 90% 34%);

  /* Accent (violet) */
  --mdt-violet-50: hsl(258 100% 96%);
  --mdt-violet-100: hsl(258 96% 90%);
  --mdt-violet-200: hsl(258 90% 84%);
  --mdt-violet-300: hsl(258 88% 76%);
  --mdt-violet-400: hsl(258 86% 70%);
  --mdt-violet-500: hsl(258 82% 66%);
  --mdt-violet-600: hsl(258 80% 58%);
  --mdt-violet-700: hsl(258 78% 50%);

  /* Status hues */
  --mdt-success-500: hsl(157 60% 46%);
  --mdt-success-600: hsl(157 62% 40%);
  --mdt-warning-500: hsl(38 92% 50%);
  --mdt-warning-600: hsl(38 92% 44%);
  --mdt-danger-500: hsl(349 74% 52%);
  --mdt-danger-600: hsl(349 76% 46%);
  --mdt-info-500: hsl(210 90% 55%);
  --mdt-info-600: hsl(210 92% 48%);

  /* ==== Semantic color roles (light) ==== */
  --mdt-color-primary: var(--mdt-brand-500);
  --mdt-color-primary-strong: var(--mdt-brand-600);
  --mdt-color-primary-soft: var(--mdt-brand-100);
  --mdt-color-accent: var(--mdt-violet-500);
  --mdt-color-accent-soft: var(--mdt-violet-100);
  --mdt-color-success: var(--mdt-success-500);
  --mdt-color-warning: var(--mdt-warning-500);
  --mdt-color-danger: var(--mdt-danger-500);
  --mdt-color-info: var(--mdt-info-500);

  /* Surfaces */
  --mdt-color-bg: var(--mdt-neutral-25);
  --mdt-color-surface: var(--mdt-neutral-0);
  --mdt-color-surface-subtle: var(--mdt-neutral-50);
  --mdt-color-surface-strong: var(--mdt-neutral-100);
  --mdt-color-surface-raised: var(--mdt-neutral-0);
  --mdt-color-overlay: hsl(222 50% 8% / 0.45);

  /* Lines + rings */
  --mdt-color-border: var(--mdt-neutral-200);
  --mdt-color-border-strong: var(--mdt-neutral-300);
  --mdt-color-ring: hsl(198 85% 52% / 0.55);

  /* Text */
  --mdt-color-text: var(--mdt-neutral-900);
  --mdt-color-text-muted: var(--mdt-neutral-600);
  --mdt-color-text-subtle: var(--mdt-neutral-500);
  --mdt-color-text-on-strong: hsl(0 0% 100%);

  /* Data viz palette */
  --mdt-data-1: var(--mdt-brand-500);
  --mdt-data-2: var(--mdt-violet-500);
  --mdt-data-3: var(--mdt-success-500);
  --mdt-data-4: var(--mdt-warning-500);
  --mdt-data-5: var(--mdt-danger-500);
  --mdt-data-6: var(--mdt-info-500);
  --mdt-data-7: hsl(280 60% 58%);
  --mdt-data-8: hsl(120 55% 42%);

  /* Typography tokens (sizes are CSS vars for runtime theming) */
  --mdt-font-weight-regular: 400;
  --mdt-font-weight-medium: 500;
  --mdt-font-weight-semibold: 600;
  --mdt-font-weight-bold: 700;

  --mdt-type-display-size: 2.25rem;
  --mdt-type-display-lh: 1.2;
  --mdt-type-display-fw: var(--mdt-font-weight-semibold);

  --mdt-type-h1-size: 1.875rem;
  --mdt-type-h1-lh: 1.25;
  --mdt-type-h1-fw: var(--mdt-font-weight-semibold);

  --mdt-type-h2-size: 1.5rem;
  --mdt-type-h2-lh: 1.3;
  --mdt-type-h2-fw: var(--mdt-font-weight-semibold);

  --mdt-type-h3-size: 1.25rem;
  --mdt-type-h3-lh: 1.3;
  --mdt-type-h3-fw: var(--mdt-font-weight-medium);

  --mdt-type-body-size: 1rem;
  --mdt-type-body-lh: 1.6;
  --mdt-type-body-fw: var(--mdt-font-weight-regular);

  --mdt-type-body-sm-size: 0.875rem;
  --mdt-type-body-sm-lh: 1.5;
  --mdt-type-body-sm-fw: var(--mdt-font-weight-regular);

  --mdt-type-caption-size: 0.75rem;
  --mdt-type-caption-lh: 1.4;
  --mdt-type-caption-fw: var(--mdt-font-weight-regular);

  /* Shadows */
  --mdt-shadow-sm: 0 10px 30px hsl(222 47% 11% / 0.08);
  --mdt-shadow-md: 0 18px 40px hsl(222 47% 11% / 0.12);
  --mdt-shadow-lg: 0 26px 60px hsl(222 47% 11% / 0.16);
  --mdt-shadow-glow: 0 0 0 1px hsl(198 85% 52% / 0.16), 0 16px 48px hsl(222 47% 11% / 0.18);
  --mdt-shadow-focus: 0 0 0 3px var(--mdt-color-ring);

  /* Radii */
  --mdt-radius-sm: 6px;
  --mdt-radius-md: 10px;
  --mdt-radius-lg: 16px;
  --mdt-radius-pill: 999px;

  /* Legacy radii aliases */
  --radius-sm: var(--mdt-radius-sm);
  --radius-md: var(--mdt-radius-md);
  --radius-lg: var(--mdt-radius-lg);
  --radius-pill: var(--mdt-radius-pill);

  /* Motion */
  --mdt-motion-fast: 120ms;
  --mdt-motion-base: 180ms;
  --mdt-motion-slow: 260ms;
  --mdt-motion-exit: 150ms;
  --mdt-motion-enter: 220ms;
  --mdt-motion-ease-emphasized: cubic-bezier(0.16, 1, 0.3, 1);
  --mdt-motion-ease-standard: cubic-bezier(0.2, 0, 0, 1);
  --mdt-motion-ease-snappy: cubic-bezier(0.34, 1.56, 0.64, 1);
  --mdt-motion-distance-short: 6px;
  --mdt-motion-distance-mid: 16px;
  --mdt-motion-distance-far: 32px;

  /* Spacing tokens (4/8 base) */
  --mdt-space-0: 0px;
  --mdt-space-1: 4px;
  --mdt-space-2: 8px;
  --mdt-space-3: 12px;
  --mdt-space-4: 16px;
  --mdt-space-5: 20px;
  --mdt-space-6: 24px;
  --mdt-space-7: 28px;
  --mdt-space-8: 32px;
  --mdt-space-9: 36px;
  --mdt-space-10: 40px;
  --mdt-space-12: 48px;

  /* Legacy spacing aliases */
  --space-1: var(--mdt-space-1);
  --space-2: var(--mdt-space-2);
  --space-3: var(--mdt-space-3);
  --space-4: var(--mdt-space-4);
  --space-5: var(--mdt-space-5);
  --space-6: var(--mdt-space-6);
  --space-8: var(--mdt-space-8);
  --space-10: var(--mdt-space-10);
  --space-12: var(--mdt-space-12);
}

.dark {
  /* ==== Primitive palette (dark) ==== */
  --mdt-neutral-0: hsl(220 18% 6%);
  --mdt-neutral-25: hsl(220 18% 8%);
  --mdt-neutral-50: hsl(220 18% 10%);
  --mdt-neutral-100: hsl(220 16% 14%);
  --mdt-neutral-200: hsl(220 16% 18%);
  --mdt-neutral-300: hsl(220 16% 22%);
  --mdt-neutral-400: hsl(220 16% 28%);
  --mdt-neutral-500: hsl(220 18% 38%);
  --mdt-neutral-600: hsl(220 15% 64%);
  --mdt-neutral-700: hsl(220 15% 74%);
  --mdt-neutral-800: hsl(220 20% 84%);
  --mdt-neutral-900: hsl(220 33% 92%);
  --mdt-neutral-950: hsl(0 0% 100%);

  --mdt-brand-50: hsl(198 80% 22% / 0.7);
  --mdt-brand-100: hsl(198 82% 28% / 0.55);
  --mdt-brand-200: hsl(198 84% 36%);
  --mdt-brand-300: hsl(198 86% 48%);
  --mdt-brand-400: hsl(198 86% 56%);
  --mdt-brand-500: hsl(198 86% 62%);
  --mdt-brand-600: hsl(198 88% 72%);
  --mdt-brand-700: hsl(198 90% 80%);

  --mdt-violet-50: hsl(258 84% 28% / 0.55);
  --mdt-violet-100: hsl(258 86% 36% / 0.6);
  --mdt-violet-200: hsl(258 88% 46%);
  --mdt-violet-300: hsl(258 90% 56%);
  --mdt-violet-400: hsl(258 92% 64%);
  --mdt-violet-500: hsl(258 85% 72%);
  --mdt-violet-600: hsl(258 88% 78%);
  --mdt-violet-700: hsl(258 90% 84%);

  --mdt-success-500: hsl(157 58% 56%);
  --mdt-success-600: hsl(157 60% 62%);
  --mdt-warning-500: hsl(38 95% 60%);
  --mdt-warning-600: hsl(38 98% 66%);
  --mdt-danger-500: hsl(349 76% 62%);
  --mdt-danger-600: hsl(349 78% 68%);
  --mdt-info-500: hsl(210 92% 70%);
  --mdt-info-600: hsl(210 94% 76%);

  /* ==== Semantic color roles (dark) ==== */
  --mdt-color-primary: var(--mdt-brand-500);
  --mdt-color-primary-strong: var(--mdt-brand-600);
  --mdt-color-primary-soft: var(--mdt-brand-50);
  --mdt-color-accent: var(--mdt-violet-500);
  --mdt-color-accent-soft: var(--mdt-violet-50);
  --mdt-color-success: var(--mdt-success-500);
  --mdt-color-warning: var(--mdt-warning-500);
  --mdt-color-danger: var(--mdt-danger-500);
  --mdt-color-info: var(--mdt-info-500);

  --mdt-color-bg: var(--mdt-neutral-0);
  --mdt-color-surface: var(--mdt-neutral-50);
  --mdt-color-surface-subtle: var(--mdt-neutral-100);
  --mdt-color-surface-strong: var(--mdt-neutral-200);
  --mdt-color-surface-raised: var(--mdt-neutral-300);
  --mdt-color-overlay: hsl(220 32% 4% / 0.7);

  --mdt-color-border: var(--mdt-neutral-400);
  --mdt-color-border-strong: var(--mdt-neutral-500);
  --mdt-color-ring: hsl(198 88% 65% / 0.45);

  --mdt-color-text: var(--mdt-neutral-900);
  --mdt-color-text-muted: var(--mdt-neutral-700);
  --mdt-color-text-subtle: var(--mdt-neutral-600);
  --mdt-color-text-on-strong: hsl(220 16% 12%);

  --mdt-data-1: var(--mdt-brand-500);
  --mdt-data-2: var(--mdt-violet-500);
  --mdt-data-3: var(--mdt-success-500);
  --mdt-data-4: var(--mdt-warning-500);
  --mdt-data-5: var(--mdt-danger-500);
  --mdt-data-6: var(--mdt-info-500);
  --mdt-data-7: hsl(280 70% 65%);
  --mdt-data-8: hsl(120 60% 52%);

  --mdt-shadow-sm: 0 10px 30px hsl(220 33% 4% / 0.35);
  --mdt-shadow-md: 0 18px 40px hsl(220 33% 3% / 0.45);
  --mdt-shadow-lg: 0 26px 60px hsl(220 33% 3% / 0.6);
  --mdt-shadow-glow: 0 0 0 1px hsl(198 88% 65% / 0.22), 0 16px 48px hsl(220 33% 3% / 0.5);
  --mdt-shadow-focus: 0 0 0 3px var(--mdt-color-ring);

  --mdt-radius-sm: 6px;
  --mdt-radius-md: 10px;
  --mdt-radius-lg: 16px;
  --mdt-radius-pill: 999px;

  --radius-sm: var(--mdt-radius-sm);
  --radius-md: var(--mdt-radius-md);
  --radius-lg: var(--mdt-radius-lg);
  --radius-pill: var(--mdt-radius-pill);

  --mdt-motion-fast: 120ms;
  --mdt-motion-base: 180ms;
  --mdt-motion-slow: 260ms;
  --mdt-motion-exit: 150ms;
  --mdt-motion-enter: 220ms;
  --mdt-motion-ease-emphasized: cubic-bezier(0.16, 1, 0.3, 1);
  --mdt-motion-ease-standard: cubic-bezier(0.2, 0, 0, 1);
  --mdt-motion-ease-snappy: cubic-bezier(0.34, 1.56, 0.64, 1);
  --mdt-motion-distance-short: 6px;
  --mdt-motion-distance-mid: 16px;
  --mdt-motion-distance-far: 32px;

  --mdt-space-0: 0px;
  --mdt-space-1: 4px;
  --mdt-space-2: 8px;
  --mdt-space-3: 12px;
  --mdt-space-4: 16px;
  --mdt-space-5: 20px;
  --mdt-space-6: 24px;
  --mdt-space-7: 28px;
  --mdt-space-8: 32px;
  --mdt-space-9: 36px;
  --mdt-space-10: 40px;
  --mdt-space-12: 48px;

  --space-1: var(--mdt-space-1);
  --space-2: var(--mdt-space-2);
  --space-3: var(--mdt-space-3);
  --space-4: var(--mdt-space-4);
  --space-5: var(--mdt-space-5);
  --space-6: var(--mdt-space-6);
  --space-8: var(--mdt-space-8);
  --space-10: var(--mdt-space-10);
  --space-12: var(--mdt-space-12);
}

@layer base {
  html,
  body {
    background-color: var(--mdt-color-bg);
    color: var(--mdt-color-text);
    font-family: var(--font-inter), system-ui, -apple-system, sans-serif;
  }

  .dark html,
  .dark body {
    background-color: var(--mdt-color-bg);
    color: var(--mdt-color-text);
  }

  :focus-visible {
    outline: 2px solid var(--mdt-color-ring);
    outline-offset: 3px;
  }
}

@layer components {
  .btn {
    @apply inline-flex items-center justify-center gap-2 rounded-mdt-pill
      px-4 py-2 text-[0.95rem] font-medium transition
      duration-150 ease-out border border-transparent;
  }

  .btn-primary {
    @apply bg-mdt-blue text-white shadow-mdt-btn;
  }
  .btn-primary:hover {
    @apply bg-[color:var(--mdt-color-primary-strong)] shadow-mdt-btn-hover -translate-y-[1px];
  }
  .btn-primary:active {
    @apply translate-y-0 shadow-mdt-sm;
  }

  .btn-secondary {
    @apply bg-mdt-surface text-mdt-text border-mdt-border;
  }
  .btn-secondary:hover {
    @apply bg-mdt-surface-subtle;
  }
  .dark .btn-secondary {
    @apply bg-mdt-surface text-mdt-text border-mdt-border;
  }
  .dark .btn-secondary:hover {
    @apply bg-mdt-surface-subtle;
  }

  .card {
    @apply bg-mdt-surface rounded-mdt-md border border-mdt-border
      shadow-mdt-sm p-4 transition duration-mdt-base ease-mdt-emphasized;
  }
  .card:hover {
    @apply shadow-mdt-md border-[color:var(--mdt-color-surface-strong)] -translate-y-[1px];
  }

  .pill {
    @apply inline-flex items-center rounded-mdt-pill px-2 py-[2px]
    text-caption font-medium;
  }
  .pill-primary {
    @apply bg-[color:var(--mdt-color-primary-soft)] text-[color:var(--mdt-color-primary-strong)];
  }
  .pill-yellow {
    @apply bg-[color:var(--mdt-color-accent-soft)] text-[color:var(--mdt-color-accent)];
  }
  .pill-blue {
    @apply bg-[color:var(--mdt-color-info)]/15 text-[color:var(--mdt-color-info)];
  }
  .pill-red {
    @apply bg-[color:var(--mdt-color-danger)]/16 text-[color:var(--mdt-color-danger)];
  }
  .pill-green {
    @apply bg-[color:var(--mdt-color-success)]/15 text-[color:var(--mdt-color-success)];
  }
  .pill-gray {
    @apply bg-[color:var(--mdt-color-surface-strong)] text-[color:var(--mdt-color-text)];
  }

  .skip-link {
    @apply absolute left-[-999px] top-[-999px] z-50 rounded-mdt-pill bg-mdt-blue px-3 py-2 text-sm font-medium text-white;
  }
  .skip-link:focus-visible {
    @apply left-3 top-3;
  }
}

@layer utilities {
  .motion-fade-in {
    animation: mdt-fade-in var(--mdt-motion-enter) var(--mdt-motion-ease-standard) both;
  }
  .motion-slide-up {
    animation: mdt-slide-up var(--mdt-motion-enter) var(--mdt-motion-ease-emphasized) both;
  }
  .motion-scale-in {
    animation: mdt-scale-in var(--mdt-motion-enter) var(--mdt-motion-ease-snappy) both;
  }
  .motion-skeleton {
    background: linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.04) 0%,
      rgba(255, 255, 255, 0.14) 50%,
      rgba(255, 255, 255, 0.04) 100%
    );
    background-size: 200% 100%;
    animation: mdt-skeleton 1.4s var(--mdt-motion-ease-standard) infinite;
  }
}

@keyframes mdt-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes mdt-slide-up {
  from {
    transform: translateY(var(--mdt-motion-distance-mid));
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes mdt-scale-in {
  from {
    transform: scale(0.97);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes mdt-skeleton {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

.dark .motion-skeleton {
  background: linear-gradient(
    90deg,
    rgba(255, 255, 255, 0.05) 0%,
    rgba(255, 255, 255, 0.12) 50%,
    rgba(255, 255, 255, 0.05) 100%
  );
}

@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001ms !important;
  }
}

.markdown-preview {
  font-size: 0.95rem;
  line-height: 1.6;
  color: var(--mdt-color-text);
}

.markdown-preview h1,
.markdown-preview h2,
.markdown-preview h3 {
  margin-top: 1rem;
  margin-bottom: 0.5rem;
  font-weight: 600;
}

.markdown-preview p {
  margin-bottom: 0.75rem;
}

.markdown-preview code {
  padding: 0.1rem 0.35rem;
  background: var(--mdt-color-surface-subtle);
  border-radius: 0.25rem;
  font-size: 0.9rem;
  color: var(--mdt-color-text);
}
.dark .markdown-preview code {
  background: var(--mdt-color-surface-strong);
  color: var(--mdt-color-text);
}

.markdown-preview pre {
  background: var(--mdt-color-surface-strong);
  color: var(--mdt-color-text);
  padding: 0.75rem;
  border-radius: 0.5rem;
  overflow-x: auto;
  font-size: 0.9rem;
}
.dark .markdown-preview pre {
  background: var(--mdt-color-surface-subtle);
}

@media (max-width: 768px) {
  .composer-grid {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
  .composer-panel {
    width: 100%;
  }
}
